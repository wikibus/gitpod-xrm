PREFIX rr: <http://www.w3.org/ns/r2rml#>
PREFIX acl: <http://www.w3.org/ns/auth/acl#>
PREFIX hydra: <http://www.w3.org/ns/hydra/core#>
PREFIX wbo: <https://schema.wikibus.org/>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>

<#WishlistItem>
	a rr:TriplesMap;
	
	rr:logicalTable [ rr:sqlQuery """select Id, rtrim([User]) as [User], SourceId, Done from Sources.Wishlist""" ];
	
	rr:subjectMap [
		rr:template "wishlist/{User}/{SourceId}";
		rr:class wbo:WishlistItem;
		rr:graphMap [
		  rr:template "wishlist/{User}/{SourceId}"
		]
	];
	
	rr:predicateObjectMap [
		rr:predicate wbo:source;
		rr:objectMap [
			rr:template "brochure/{SourceId}"
		]
	];
	
	rr:predicateObjectMap [
		rr:predicate wbo:done;
		rr:objectMap [
			rr:column "Done";
			rr:datatype xsd:boolean
		]
	];
	
	rr:predicateObjectMap [
		rr:predicate acl:owner;
		rr:objectMap [
			rr:template "https://users.wikibus.org/user/{User}"
		]
	].
	
<#Wishlists>
	a rr:TriplesMap;
	
	rr:logicalTable [ rr:sqlQuery """select rtrim([UserId]) as [UserId], DriveImportFolder from [Sources].[Users]""" ];
	
	rr:subjectMap [
		rr:template "wishlist/{UserId}";
		rr:class wbo:WishlistCollection;
		rr:graphMap [
		  rr:template "wishlist/{UserId}"
		]
	];
	
	rr:predicateObjectMap [
		rr:predicate acl:owner;
		rr:objectMap [
			rr:template "https://users.wikibus.org/user/{UserId}"
		]
	];
	
	rr:predicateObjectMap [
		rr:predicate hydra:manages;
		rr:objectMap [
			rr:template "wishlist-{UserId}-manages-user";
			rr:termType rr:BlankNode
		]
	].
	
<#WishlistCollectionsManagesUser>
	a rr:TriplesMap;
	
	rr:logicalTable [ rr:sqlQuery """select rtrim([UserId]) as [UserId], DriveImportFolder from [Sources].[Users]""" ];
	
	rr:subjectMap [
		rr:template "wishlist-{UserId}-manages-user";
		rr:termType rr:BlankNode;
		rr:graphMap [
		  rr:template "wishlist/{UserId}"
		]
	];
	
	rr:predicateObjectMap [
		rr:predicate hydra:object;
		rr:objectMap [
			rr:template "https://users.wikibus.org/user/{UserId}"
		]
	];
	
	rr:predicateObjectMap [
		rr:predicate hydra:property;
		rr:objectMap [
			rr:constant acl:owner
		]
	].
	
